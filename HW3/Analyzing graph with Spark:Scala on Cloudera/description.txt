We use a case class to define schema for the table (11). Arguments to case class are read using reflection after being separated at tab space and is converted to a data frame (24). We make use of filter to remove entries with weight = 1(27). We create 2 data frames with the following mapping, 1. [node -> sum of outgoing edge weights] (29) Ð using groupBy on ÒsrcÓ2. [node -> sum of incoming edge weights] (31) Ð using groupBy on ÒtgtÓFinally, we join on the node values from both data frames and use selectExpr to create a data frame,[node -> sum of incoming edge weights Ð sum of outgoing edge weights] (33)The data frame is formatted as tab separated string values (36) and output is written to a file stored in HDFS (40) using saveAsTextFile